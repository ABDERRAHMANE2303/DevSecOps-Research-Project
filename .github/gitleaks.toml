extends = "github://gitleaks/gitleaks/v8/config/gitleaks.toml"
title = "Gitleaks Configuration"

[allowlist]
# Treat these as regex-ish globs; they match paths from repo root
paths = [
  "^vendor/.*",
  "^node_modules/.*",
  ".*\\.phar$"
  # Avoid blanket ignores for public/ and storage/
]

# Examples of known-safe tokens (keep specific)
regexes = [
  "example_api_key_[0-9A-Za-z]+",
  "dummy_token_[0-9A-Za-z]+"
]

commits = [
  "dependabot",
  "github-actions"
]

# Optional: extra rules (defaults are still loaded because of `extends`)
[[rules]]
description = "Hardcoded password or secret in YAML or ENV file"
regex = '''(?i)(password|secret|pwd|token|key)["']?\s*[:=]\s*["']?[A-Za-z0-9!@#$%^&*()_\-+=]{4,}["']?'''
tags = ["secrets", "password"]

[[rules]]
description = "AWS Access Key (extra)"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["aws", "key"]

[[rules]]
description = "Private RSA Key (extra)"
regex = '''-----BEGIN RSA PRIVATE KEY-----'''
tags = ["rsa", "private", "key"]
